# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."


## Задача 1
Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

### Ответ:
```
Основные отличия в логике использования хостовой и гостевых операционных систем. 

Для полной характерно: хостовая ОС = гипервизор, при этом гостевая ос использует свои собственные ядра, которые могут отличаться от хостовой ос.

Для паравирутализации характерно: отдельная от гипервизора хостовая ос с возможностью модификации гостевые ос. При наличие "шумного соседа" повышенная нагрузка может передаваться на хостовую ОС. 

Для виртуализации на основе ОС характерно: изолированные гостевые ОС использующие ядра хостовой ОС с увеличенным количеством необходимых сетевых взамиодействий и единой точкой отказа при отсутствии кластеризации.
```

## Задача 2
Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

***Организация серверов:***

+ физические сервера,
+ паравиртуализация,
+ виртуализация уровня ОС.

***Условия использования:***

+ Высоконагруженная база данных, чувствительная к отказу.
+ Различные web-приложения.
+ Windows системы для использования бухгалтерским отделом.
+ Системы, выполняющие высокопроизводительные расчеты на GPU.

***Опишите, почему вы выбрали к каждому целевому использованию такую организацию.***

### Ответ:

+ ***Высоконагруженная база данных, чувствительная к отказу:***
```
Виртуализация уровня ОС. Отказоустойчивая модель с созданием нескольких изолированных контейнеров по типу master - slave,, работая как отдельный процесс, позволяя выполнять операции на чтение на реплике/ах, а на запись в master. При этом подключив мониторинг (NodeExporter - Prometheus - Grafana) с алертами, для адекватного реагирования на увеличение нагрузки с возможностью скейлить при увеличении нагрузки на CPU и Sys log "CPU, RAM, DISK могут ограничиваться отдельно для каждого контейнера.". 
```

+ ***Различные web-приложения.:***
```
Если нет особенностей с различными операционными системами, то Виртуализация уровня ОС. Позволяет утилизировать по максимуму хостовые ресурсы за счет гибкой настройки потребления системных ресурсов отдельно для каждого контейнера.
```

+ ***Windows системы для использования бухгалтерским отделом.***
```
Т.к. бухгалтерский отдел не предполагает высоконагруженные процессы с прогнозируемой массштабируемостью при необходимости, то паравиртуализация, как пример KVM с помощью которого можно запустить любую ОС в том числе и Windows, + поставляется с хорошим уровнем безопасности, что немало важно при рассчетах зарплаты, а для минимизации рисков "шумного соседа" в виде базы данных, расположение ее на отдельных нодах. Также можно рассмотреть Xen PV (паравиртуализация, более совместим с Windows), т.к. использование шаблонов быстро и без велосипедов.
```

+ ***Системы, выполняющие высокопроизводительные расчеты на GPU.:***
```
Т.к. особенно важна производительность при работе с GPU - физические сервера. Чем меньше абстракций, прослоек в виде дополнительной ОС и с большим гибким контролем за ядрами, тем лучше будет работать приложение, т.к. есть возможность прямого доступа к собственным ядрам изолированных ВМ. Также возможно понадобятся собственные патчи на ядро, что возможно только при аппаратной виртуализации.
```



## Задача 3
Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

***Сценарии:***

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

### Ответ:

***Сценарий 1:***
```
Hyper-V является выбором defacto для окружений с преобладанием технологий Microsoft. А лайв миграция,  сетевые распределенные файловые системы, миграция данных и Hyper-v Репликация позволят выполнить требования данного сценария.
```

***Сценарий 2:***
```
Xen PV, не самый лучший вариант для Windows но за счет специальных драйверов для совместимости с Windows, а также зарекомендованный как зрелый продукт с высокой "производительностью и исключительной стабильностью" является выбором при данном сценарии.

"Стабильность Xen обеспечивается, за счет, предварительно выделяемой RAM и CPU для гипервизора, а так как он имеет свои собственные выделенные ресурсы, то на него не могут повлиять гостевые ОС, что и дает пресловутую стабильность в работе"
```

***Сценарий 3:***
```
В данном случае KVM т.к. более совместима с Windows по сравнению с Xen, а с драйвером virtio получим близкую к нативной производительность.
```

***Сценарий 4:***
```
VirtualBox + Vagrant позволит добиться возможности установки разных дистрибутивов Linux на отдельных ВМ, а Vagrant позволит добиться автоматизации за счет прозрачных конфигов для каждого дистрибутива с вычленением потоков stderror и детальным strace при необходимости (как вариант)
```

## Задача 4
Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

### Ответ:

```
Думаю чем унифицированнее подход при проектировании тем легче управлять, т.к. под разные системы управления необходим разный отдельный подход при поддержке и массштабировании решений, что накладывает опечатки на затратах и уровнях квалификации членов команды. 

Если стоит такая задача то под каждый вариант необходимо выработать автоматизацию, покрывающей 99% сравнимых задач, чтобы оставить время для творчества и решения нетиповых задач под каждую систему управления и также переводить решения в код для дальнейшего пополнения коллекции автоматизированных решений.
```
